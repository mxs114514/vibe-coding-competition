# AI 食谱生成器 - MVP 开发流程规划

## 项目概述

**项目名称:** AI 食谱生成器 - "冰箱里有啥做啥"
**开发模式:** MVP（最小可行产品）迭代开发
**技术栈:**
- 前端: Vue 3 + TypeScript + Vite + Tailwind CSS
- 后端: Java + Spring Boot（前后端分离架构）
- 数据库: MySQL（开发和生产）
- AI 服务: 通义千问（阿里云百炼）

**架构决策:**
- ✅ 采用前后端分离架构（安全性高，数据持久化）
- ✅ 使用国内大模型通义千问（访问稳定，成本可控）
- ✅ 支持深色模式（提升用户体验）
- ✅ 集成菜谱图片（AI生成或搜索获取）

## MVP 开发策略

采用三阶段迭代开发，每个阶段都能产出可用的产品：

### 阶段 1: 核心 MVP（2-3周）
**目标:** 实现最基本的"输入食材 → 生成菜谱"流程 + 深色模式 + 菜谱图片

### 阶段 2: 功能增强（1-2周）
**目标:** 添加筛选、收藏等提升用户体验的功能

### 阶段 3: 进阶功能（2-3周）
**目标:** 实现智能替代、营养分析等高级功能

---

## 阶段 1: 核心 MVP 开发

### 1.1 技术架构（已确定）

**前后端分离架构:**
```
┌─────────────────────────────────────┐
│   前端（Vue 3 + TypeScript）        │
│   - 食材输入界面                    │
│   - 菜谱展示组件                    │
│   - 深色模式切换                    │
├─────────────────────────────────────┤
│   RESTful API（HTTP/JSON）          │
├─────────────────────────────────────┤
│   后端（Java + Spring Boot）        │
│   - 食谱生成服务                    │
│   - 图片搜索服务                    │
│   - 用户数据管理                    │
├─────────────────────────────────────┤
│   数据库（MySQL）                   │
│   - 用户表                          │
│   - 食材表                          │
│   - 菜谱表（缓存）                  │
├─────────────────────────────────────┤
│   外部服务                          │
│   - 通义千问 API                    │
│   - 图片搜索 API（可选）            │
└─────────────────────────────────────┘
```

**技术栈详情:**
- **前端:** Vue 3.5+ + TypeScript 5.9+ + Vite 7+ + Tailwind CSS 4+
- **后端:** Java 17+ + Spring Boot 3.x + Spring Data JPA
- **数据库:** MySQL 8.0+
- **AI服务:** 阿里云百炼（通义千问 qwen-turbo）
- **图片服务:** Unsplash API / Pexels API（免费）

### 1.2 后端基础搭建

#### 任务 1: Spring Boot 项目初始化
**优先级:** P0（必须）

**实现内容:**
- 创建 Spring Boot 项目（使用 Spring Initializr）
- 配置 Maven 依赖（Spring Web, Spring Data JPA, MySQL Driver, Lombok）
- 添加通义千问 SDK（DashScope SDK）
- 配置 application.yml（数据库连接、API Key）
- 实现跨域配置（CORS）

**技术要点:**
- Spring Boot 3.x + Java 17
- RESTful API 规范
- 环境变量管理（开发/生产环境隔离）

**文件涉及:**
- `backend/pom.xml` - Maven 依赖配置
- `backend/src/main/resources/application.yml` - 应用配置
- `backend/src/main/java/com/momo/config/CorsConfig.java` - 跨域配置
- `backend/src/main/java/com/momo/MomoApplication.java` - 应用入口

#### 任务 2: 数据库设计与实现
**优先级:** P0（必须）

**数据表设计:**

**1. 食材表（ingredients）**
```sql
CREATE TABLE ingredients (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL COMMENT '食材名称',
    category VARCHAR(20) COMMENT '分类：蔬菜/肉类/海鲜/主食/调味料',
    unit VARCHAR(10) COMMENT '单位：克/个/毫升',
    is_common TINYINT DEFAULT 0 COMMENT '是否常用食材',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY uk_name (name)
);
```

**2. 菜谱表（recipes）**
```sql
CREATE TABLE recipes (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL COMMENT '菜品名称',
    cuisine VARCHAR(20) COMMENT '菜系：中餐/西餐/日韩/东南亚',
    ingredients_input TEXT COMMENT '输入的食材列表（JSON）',
    ingredients_available TEXT COMMENT '已有食材（JSON）',
    ingredients_needed TEXT COMMENT '需要购买的食材（JSON）',
    steps TEXT COMMENT '烹饪步骤（JSON）',
    cooking_time INT COMMENT '烹饪时间（分钟）',
    difficulty VARCHAR(10) COMMENT '难度：简单/中等/复杂',
    image_url VARCHAR(255) COMMENT '菜谱图片URL',
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_cuisine (cuisine),
    INDEX idx_difficulty (difficulty)
);
```

**3. 用户收藏表（favorites）**
```sql
CREATE TABLE favorites (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT COMMENT '用户ID（阶段1可为空）',
    recipe_id BIGINT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (recipe_id) REFERENCES recipes(id),
    UNIQUE KEY uk_user_recipe (user_id, recipe_id)
);
```

**文件涉及:**
- `backend/src/main/resources/db/migration/V1__init_schema.sql` - 数据库初始化脚本
- `backend/src/main/java/com/momo/entity/Ingredient.java` - 食材实体
- `backend/src/main/java/com/momo/entity/Recipe.java` - 菜谱实体
- `backend/src/main/java/com/momo/repository/IngredientRepository.java` - 食材仓储
- `backend/src/main/java/com/momo/repository/RecipeRepository.java` - 菜谱仓储

#### 任务 3: 通义千问集成
**优先级:** P0（必须）

**实现内容:**
- 封装通义千问 API 调用
- 实现结构化 Prompt（生成 JSON 格式菜谱）
- 错误处理和重试机制
- 响应解析和数据转换

**技术要点:**
- 使用 DashScope Java SDK
- 实现适配器模式（便于后续切换模型）
- 添加请求日志和监控

**文件涉及:**
- `backend/src/main/java/com/momo/service/ai/AIService.java` - AI 服务接口
- `backend/src/main/java/com/momo/service/ai/impl/QwenServiceImpl.java` - 通义千问实现
- `backend/src/main/java/com/momo/dto/RecipeRequest.java` - 菜谱生成请求 DTO
- `backend/src/main/java/com/momo/dto/RecipeResponse.java` - 菜谱生成响应 DTO

**AI Prompt 设计（优化版）:**
```java
String prompt = String.format("""
    你是一个专业的中餐厨师助手。用户提供了以下食材：%s

    请生成 3 道创意菜谱，要求：
    1. 菜品必须可行且美味
    2. 尽量使用用户提供的食材
    3. 缺少的食材要常见且易购买
    4. 步骤详细但不冗长

    请严格按照以下 JSON 格式返回（不要添加任何其他文本）：
    {
      "recipes": [
        {
          "name": "菜品名称",
          "cuisine": "中餐",
          "ingredients": {
            "available": ["番茄", "鸡蛋"],
            "needed": ["葱", "盐", "油"]
          },
          "steps": [
            "1. 番茄切块，鸡蛋打散",
            "2. 热锅倒油，炒鸡蛋至凝固",
            "3. 加入番茄翻炒"
          ],
          "cookingTime": 15,
          "difficulty": "简单"
        }
      ]
    }
    """, ingredientsStr);
```

#### 任务 4: 菜谱生成 API 实现
**优先级:** P0（必须）

**API 端点设计:**

**1. 生成菜谱**
```
POST /api/recipes/generate
请求体:
{
  "ingredients": ["番茄", "鸡蛋", "葱"],
  "filters": {
    "cuisine": "中餐",      // 可选
    "cookingTime": 30,      // 可选，分钟
    "difficulty": "简单"    // 可选
  }
}

响应:
{
  "code": 200,
  "message": "success",
  "data": {
    "recipes": [
      {
        "id": 1,
        "name": "番茄炒蛋",
        "cuisine": "中餐",
        "ingredients": {
          "available": ["番茄", "鸡蛋"],
          "needed": ["葱", "盐", "油"]
        },
        "steps": ["步骤1", "步骤2", ...],
        "cookingTime": 15,
        "difficulty": "简单",
        "imageUrl": "https://..."
      }
    ]
  }
}
```

**2. 获取常用食材列表**
```
GET /api/ingredients/common

响应:
{
  "code": 200,
  "data": {
    "categories": {
      "蔬菜": ["番茄", "黄瓜", "土豆"],
      "肉类": ["猪肉", "鸡肉", "牛肉"],
      "海鲜": ["虾", "鱼", "蟹"],
      "主食": ["米饭", "面条", "馒头"],
      "调味料": ["盐", "油", "酱油"]
    }
  }
}
```

**文件涉及:**
- `backend/src/main/java/com/momo/controller/RecipeController.java` - 菜谱控制器
- `backend/src/main/java/com/momo/controller/IngredientController.java` - 食材控制器
- `backend/src/main/java/com/momo/service/RecipeService.java` - 菜谱服务
- `backend/src/main/java/com/momo/common/ApiResponse.java` - 统一响应格式

### 1.3 前端核心功能实现

#### 功能 1: 食材输入界面
**优先级:** P0（必须）

**实现内容:**
- 食材输入框（支持搜索和自由输入）
- 食材标签展示（可删除）
- 常见食材快速选择（分类按钮）
- 深色模式切换按钮

**技术要点:**
- 使用 Vue 3 Composition API
- 使用 Pinia 管理食材状态
- Tailwind CSS 实现响应式布局和深色模式

**文件涉及:**
- `frontend/src/stores/ingredients.ts` - 食材状态管理
- `frontend/src/stores/theme.ts` - 主题状态管理
- `frontend/src/components/IngredientInput.vue` - 食材输入组件
- `frontend/src/components/ThemeToggle.vue` - 深色模式切换组件
- `frontend/src/views/HomeView.vue` - 主页面集成

#### 功能 2: 菜谱展示与图片集成
**优先级:** P0（必须）

**实现内容:**
- 调用后端 API 生成 3 道菜谱
- 显示菜品名称、食材清单、烹饪步骤、烹饪时间、难度
- 显示菜谱图片（从后端获取或前端搜索）
- 加载状态和错误处理

**技术要点:**
- 使用 Axios 调用后端 API
- 图片懒加载（优化性能）
- 骨架屏加载效果

**文件涉及:**
- `frontend/src/services/api.ts` - API 服务封装
- `frontend/src/components/RecipeCard.vue` - 菜谱卡片组件（含图片）
- `frontend/src/components/RecipeList.vue` - 菜谱列表组件
- `frontend/src/components/RecipeSkeleton.vue` - 骨架屏组件

**菜谱图片获取方案:**

**方案 A: 后端调用图片搜索 API（推荐）**
- 使用 Unsplash API / Pexels API
- 根据菜品名称搜索相关图片
- 缓存图片 URL 到数据库

**方案 B: 前端直接搜索（备选）**
- 前端调用图片 API
- 减少后端压力
- 但增加前端复杂度

**推荐实现（后端）:**
```java
@Service
public class ImageService {
    public String searchRecipeImage(String recipeName) {
        // 调用 Unsplash API 搜索图片
        String apiUrl = String.format(
            "https://api.unsplash.com/search/photos?query=%s food&client_id=%s",
            recipeName, apiKey
        );
        // 返回第一张图片的 URL
    }
}
```

**AI Prompt 设计:**
```
你是一个专业的厨师助手。用户提供了以下食材：{ingredients}

请生成 3 道可行的菜谱，每道菜谱必须包含：
1. 菜品名称（有创意）
2. 所需食材清单（标注哪些是用户已有的，哪些需要额外购买）
3. 详细烹饪步骤（分步说明）
4. 预估烹饪时间（分钟）
5. 难度等级（简单/中等/复杂）

请以 JSON 格式返回，格式如下：
{
  "recipes": [
    {
      "name": "菜品名称",
      "ingredients": {
        "available": ["用户已有的食材"],
        "needed": ["需要购买的食材"]
      },
      "steps": ["步骤1", "步骤2", ...],
      "cookingTime": 30,
      "difficulty": "简单"
    }
  ]
}
```

#### 功能 3: 深色模式实现
**优先级:** P0（必须）

**实现内容:**
- 全局深色模式切换
- 持久化用户偏好（LocalStorage）
- 系统主题自动检测（可选）

**技术要点:**
- Tailwind CSS dark: 类
- VueUse 的 `useDark()` 和 `useToggle()`
- CSS 变量动态切换

**文件涉及:**
- `frontend/src/stores/theme.ts` - 主题状态管理
- `frontend/src/components/ThemeToggle.vue` - 主题切换按钮
- `frontend/tailwind.config.ts` - Tailwind 深色模式配置
- `frontend/src/styles/index.css` - 深色模式样式变量

**实现示例:**
```typescript
// stores/theme.ts
import { ref, watch } from 'vue'
import { defineStore } from 'pinia'

export const useThemeStore = defineStore('theme', () => {
  const isDark = ref(false)

  // 从 LocalStorage 读取
  const savedTheme = localStorage.getItem('theme')
  if (savedTheme) {
    isDark.value = savedTheme === 'dark'
  } else {
    // 检测系统主题
    isDark.value = window.matchMedia('(prefers-color-scheme: dark)').matches
  }

  // 监听变化并持久化
  watch(isDark, (newValue) => {
    localStorage.setItem('theme', newValue ? 'dark' : 'light')
    document.documentElement.classList.toggle('dark', newValue)
  }, { immediate: true })

  const toggleTheme = () => {
    isDark.value = !isDark.value
  }

  return { isDark, toggleTheme }
})
```

#### 功能 4: 基础 UI/UX
**优先级:** P0（必须）

**实现内容:**
- 响应式布局（移动端优先）
- 加载动画和错误提示
- 图片懒加载和占位符

**技术要点:**
- Tailwind CSS 响应式类
- Vue Transition 动画
- Toast 通知组件
- Intersection Observer API（图片懒加载）

**文件涉及:**
- `frontend/src/components/LoadingSpinner.vue` - 加载动画
- `frontend/src/components/Toast.vue` - 通知组件
- `frontend/src/components/LazyImage.vue` - 懒加载图片组件
- `frontend/src/styles/index.css` - 全局样式

### 1.4 MVP 验收标准

**后端验收:**
- [ ] Spring Boot 应用可以正常启动
- [ ] 数据库表创建成功，可以正常读写
- [ ] 通义千问 API 调用成功，返回结构化菜谱数据
- [ ] POST /api/recipes/generate 接口返回 3 道菜谱
- [ ] GET /api/ingredients/common 接口返回常用食材列表
- [ ] 每道菜谱包含图片 URL（来自图片搜索 API）
- [ ] API 响应时间 < 10 秒
- [ ] 有基本的错误处理和日志记录

**前端验收:**
- [ ] 用户可以输入至少 3 种食材
- [ ] 可以从常用食材列表快速选择
- [ ] 点击生成按钮后，能在 10 秒内看到 3 道菜谱
- [ ] 每道菜谱包含名称、食材、步骤、时间、难度、图片
- [ ] 菜谱图片正常加载，有懒加载效果
- [ ] 可以切换深色模式，刷新后保持
- [ ] 深色模式下所有组件显示正常
- [ ] 界面在手机和电脑上都能正常使用
- [ ] 有加载动画和错误提示

**联调验收:**
- [ ] 前端可以成功调用后端 API
- [ ] 跨域配置正确，无 CORS 错误
- [ ] 端到端流程：输入食材 → 调用 API → 显示菜谱（含图片）

---

## 阶段 2: 功能增强

### 2.1 筛选与排序功能
**优先级:** P1（重要）

**实现内容:**
- 按菜系筛选（中餐、西餐、日韩、东南亚）
- 按烹饪时间筛选（15分钟、30分钟、1小时）
- 按难度筛选（简单、中等、复杂）

**技术要点:**
- 在 AI Prompt 中增加筛选参数
- 前端实现筛选 UI（下拉菜单或标签）
- 使用 computed 属性过滤结果

**文件涉及:**
- `frontend/src/components/FilterBar.vue` - 筛选栏组件
- `frontend/src/stores/recipes.ts` - 菜谱状态管理

### 2.2 收藏功能
**优先级:** P1（重要）

**实现内容:**
- 收藏喜欢的菜谱
- 查看收藏列表
- 取消收藏

**技术要点:**
- 使用 LocalStorage 持久化收藏数据
- 添加收藏按钮和收藏页面
- 路由配置（/favorites）

**文件涉及:**
- `frontend/src/stores/favorites.ts` - 收藏状态管理
- `frontend/src/views/FavoritesView.vue` - 收藏页面
- `frontend/src/router/index.ts` - 路由配置

### 2.3 历史记录
**优先级:** P2（可选）

**实现内容:**
- 保存最近 10 次生成记录
- 查看历史记录
- 重新生成历史食材组合

**技术要点:**
- LocalStorage 存储历史
- 时间戳和食材列表记录

**文件涉及:**
- `frontend/src/stores/history.ts` - 历史状态管理
- `frontend/src/views/HistoryView.vue` - 历史页面

### 2.4 阶段 2 验收标准

- [ ] 用户可以按菜系、时间、难度筛选菜谱
- [ ] 用户可以收藏菜谱并在收藏页面查看
- [ ] 用户可以查看最近 10 次生成记录
- [ ] 所有数据在刷新页面后仍然保留

---

## 阶段 3: 进阶功能

### 3.1 智能食材替代
**优先级:** P1（重要）

**实现内容:**
- 当缺少某种食材时，AI 推荐替代品
- 显示替代理由和调整步骤

**技术要点:**
- 在 AI Prompt 中增加替代品生成逻辑
- UI 显示替代建议

### 3.2 购物清单生成
**优先级:** P1（重要）

**实现内容:**
- 选择菜谱后生成购物清单
- 按超市区域分类
- 支持导出（复制到剪贴板）

**技术要点:**
- 提取所有"需要购买"的食材
- 分类逻辑（蔬菜区、肉类区等）
- Clipboard API 实现复制功能

**文件涉及:**
- `frontend/src/components/ShoppingList.vue` - 购物清单组件
- `frontend/src/utils/clipboard.ts` - 剪贴板工具

### 3.3 营养分析
**优先级:** P2（可选）

**实现内容:**
- 估算热量和营养成分
- 提供饮食建议
- 过敏原提示

**技术要点:**
- 在 AI Prompt 中增加营养分析要求
- 或集成第三方营养数据库 API

### 3.4 后端升级（可选）
**优先级:** P2（可选）

**实现内容:**
- 搭建 Node.js + Express 后端
- 实现用户认证（可选）
- 数据库持久化

**技术要点:**
- Express 路由设计
- JWT 认证
- SQLite/PostgreSQL 数据库

**文件涉及:**
- `backend/src/app.ts` - Express 应用入口
- `backend/src/routes/recipes.ts` - 菜谱路由
- `backend/src/services/ai.ts` - AI 服务（后端版本）
- `backend/src/models/` - 数据模型

### 3.5 阶段 3 验收标准

- [ ] 用户可以看到食材替代建议
- [ ] 用户可以生成并导出购物清单
- [ ] 用户可以查看菜谱的营养信息
- [ ] （可选）用户数据可以跨设备同步

---

## 开发流程与最佳实践

### 开发流程

**阶段 1 开发顺序（推荐）:**

**第一周：后端基础**
1. **Day 1-2:** Spring Boot 项目初始化 + 数据库设计
2. **Day 3-4:** 通义千问 API 集成 + 菜谱生成服务
3. **Day 5:** 图片搜索服务 + 菜谱生成 API
4. **Day 6:** 常用食材 API + 单元测试
5. **Day 7:** 后端联调测试（使用 Postman）

**第二周：前端开发**
1. **Day 8-9:** 食材输入组件 + 状态管理
2. **Day 10-11:** 菜谱展示组件（含图片懒加载）
3. **Day 12:** 深色模式实现
4. **Day 13:** API 集成 + 错误处理
5. **Day 14:** 前后端联调 + UI 优化

**第三周：测试与部署**
1. **Day 15-16:** 端到端测试 + Bug 修复
2. **Day 17-18:** 性能优化 + 深色模式完善
3. **Day 19:** 部署到测试环境
4. **Day 20-21:** 用户测试 + 反馈收集

**通用开发流程:**
1. **需求分析** → 确认当前阶段要实现的功能
2. **数据库设计** → 设计表结构（阶段 1 已完成）
3. **后端开发** → API 实现 + 单元测试
4. **前端开发** → 组件开发 + 状态管理
5. **联调测试** → 前后端集成测试
6. **部署上线** → 服务器部署 + 域名配置
7. **收集反馈** → 用户测试，记录问题
8. **迭代优化** → 修复 Bug，进入下一阶段

### Git 工作流

```bash
# 功能分支开发
git checkout -b feature/ingredient-input
# 开发完成后
git add .
git commit -m "feat: 实现食材输入组件"
git push origin feature/ingredient-input
# 合并到 main
git checkout main
git merge feature/ingredient-input
```

### 代码规范

- 使用 ESLint + Prettier 自动格式化
- 组件命名: PascalCase（如 `IngredientInput.vue`）
- 函数命名: camelCase（如 `generateRecipes`）
- 常量命名: UPPER_SNAKE_CASE（如 `API_BASE_URL`）
- 提交信息: 遵循 Conventional Commits（feat/fix/docs/style/refactor）

### 性能优化

- 使用 Vue 3 的 `<Suspense>` 处理异步组件
- 图片懒加载（如果有菜谱图片）
- 防抖处理（搜索输入）
- 虚拟滚动（如果菜谱列表很长）

---

## 关键文件清单

### 阶段 1 需要创建/修改的文件

**状态管理:**
- `frontend/src/stores/ingredients.ts` - 食材状态
- `frontend/src/stores/recipes.ts` - 菜谱状态

**组件:**
- `frontend/src/components/IngredientInput.vue` - 食材输入
- `frontend/src/components/RecipeCard.vue` - 菜谱卡片
- `frontend/src/components/RecipeList.vue` - 菜谱列表
- `frontend/src/components/LoadingSpinner.vue` - 加载动画
- `frontend/src/components/Toast.vue` - 通知组件

**服务:**
- `frontend/src/services/ai.ts` - AI API 调用
- `frontend/src/services/storage.ts` - LocalStorage 封装

**视图:**
- `frontend/src/views/HomeView.vue` - 主页面（重构）

**配置:**
- `frontend/.env` - 环境变量（API Key）

### 阶段 2 需要创建/修改的文件

**组件:**
- `frontend/src/components/FilterBar.vue` - 筛选栏

**视图:**
- `frontend/src/views/FavoritesView.vue` - 收藏页面
- `frontend/src/views/HistoryView.vue` - 历史页面

**状态管理:**
- `frontend/src/stores/favorites.ts` - 收藏状态
- `frontend/src/stores/history.ts` - 历史状态

**路由:**
- `frontend/src/router/index.ts` - 添加新路由

### 阶段 3 需要创建/修改的文件

**组件:**
- `frontend/src/components/ShoppingList.vue` - 购物清单
- `frontend/src/components/NutritionInfo.vue` - 营养信息

**工具:**
- `frontend/src/utils/clipboard.ts` - 剪贴板工具

**后端（可选）:**
- `backend/src/app.ts` - Express 应用
- `backend/src/routes/recipes.ts` - 菜谱路由
- `backend/src/services/ai.ts` - AI 服务
- `backend/src/models/Recipe.ts` - 菜谱模型
- `backend/src/models/User.ts` - 用户模型
- `backend/package.json` - 后端依赖

---

## 部署方案

### 前端部署（推荐 Vercel）

```bash
# 安装 Vercel CLI
npm i -g vercel

# 部署
cd frontend
vercel
```

**配置:**
- 构建命令: `npm run build`
- 输出目录: `dist`
- 环境变量: `VITE_AI_API_KEY`

### 后端部署（推荐 Railway）

```bash
# 安装 Railway CLI
npm i -g @railway/cli

# 部署
cd backend
railway login
railway init
railway up
```

---

## 测试策略

### 手动测试清单

**阶段 1:**
- [ ] 输入 3 种食材，点击生成，能看到 3 道菜谱
- [ ] 菜谱包含名称、食材、步骤、时间、难度
- [ ] 在手机上打开，界面正常显示
- [ ] 断网情况下，显示错误提示

**阶段 2:**
- [ ] 筛选功能正常工作
- [ ] 收藏菜谱后，刷新页面仍然存在
- [ ] 历史记录正确显示

**阶段 3:**
- [ ] 食材替代建议合理
- [ ] 购物清单可以复制
- [ ] 营养信息准确

### 单元测试（可选）

使用 Vitest 编写单元测试：

```bash
npm install -D vitest @vue/test-utils
```

**测试文件:**
- `frontend/src/stores/__tests__/ingredients.spec.ts`
- `frontend/src/components/__tests__/IngredientInput.spec.ts`

---

## 时间估算（前后端分离版本）

| 阶段 | 功能 | 后端工作量 | 前端工作量 | 总计 |
|------|------|-----------|-----------|------|
| **阶段 1** | | | | |
| 项目初始化 | Spring Boot + 数据库 | 2 天 | 0 天 | 2 天 |
| AI 集成 | 通义千问 API | 2-3 天 | 0 天 | 2-3 天 |
| 图片服务 | Unsplash API | 1 天 | 0 天 | 1 天 |
| 菜谱 API | 生成/获取接口 | 1-2 天 | 0 天 | 1-2 天 |
| 食材输入 | 0 天 | 2-3 天 | 2-3 天 |
| 菜谱展示 | 0 天 | 3-4 天 | 3-4 天 |
| 深色模式 | 0 天 | 1-2 天 | 1-2 天 |
| 联调测试 | 1 天 | 1 天 | 2 天 |
| **阶段 1 小计** | | **7-9 天** | **7-10 天** | **2-3 周** |
| **阶段 2** | | | | |
| 筛选排序 | API 增强 | 1-2 天 | 2-3 天 | 2-3 天 |
| 收藏功能 | 后端接口 | 2 天 | 2-3 天 | 3-4 天 |
| 历史记录 | 后端接口 | 1 天 | 1-2 天 | 2 天 |
| **阶段 2 小计** | | **4-5 天** | **5-8 天** | **1-2 周** |
| **阶段 3** | | | | |
| 智能替代 | AI Prompt 优化 | 2 天 | 1 天 | 2-3 天 |
| 购物清单 | 数据处理 | 1 天 | 2-3 天 | 2-3 天 |
| 营养分析 | AI/第三方 API | 3-4 天 | 2 天 | 4-5 天 |
| 用户认证 | Spring Security + JWT | 3-5 天 | 2-3 天 | 5-7 天 |
| **阶段 3 小计** | | **9-12 天** | **7-9 天** | **2-3 周** |

**总计:** 5-8 周（根据实际情况调整）

**说明:**
- 前后端可并行开发（后端先行 1-2 天）
- 时间估算基于单人开发，团队开发可缩短
- 包含测试和联调时间

---

## 风险与应对

### 风险 1: AI API 调用失败
**应对:**
- 实现重试机制（最多 3 次）
- 提供友好的错误提示
- 考虑使用多个 AI 服务作为备份

### 风险 2: API Key 暴露
**应对:**
- 阶段 1 使用环境变量 + .gitignore
- 阶段 3 升级到后端代理

### 风险 3: 生成的菜谱不合理
**应对:**
- 优化 AI Prompt
- 增加后处理逻辑（过滤不合理的菜谱）
- 收集用户反馈，持续优化

### 风险 4: 性能问题
**应对:**
- 使用流式响应（SSE）
- 实现缓存机制
- 优化前端渲染

---

## 验证方式

### 端到端测试流程

1. **启动开发服务器**
   ```bash
   cd frontend
   npm run dev
   ```

2. **测试核心流程**
   - 打开浏览器访问 http://localhost:5173
   - 输入食材: "鸡蛋、西红柿、葱"
   - 点击"生成菜谱"按钮
   - 等待 5-10 秒
   - 验证显示 3 道菜谱
   - 检查每道菜谱的完整性

3. **测试筛选功能**（阶段 2）
   - 选择"中餐"筛选
   - 验证只显示中餐菜谱
   - 选择"15分钟以内"
   - 验证只显示快手菜

4. **测试收藏功能**（阶段 2）
   - 点击菜谱的收藏按钮
   - 进入收藏页面
   - 验证菜谱已保存
   - 刷新页面，验证收藏仍然存在

5. **测试购物清单**（阶段 3）
   - 选择一道菜谱
   - 点击"生成购物清单"
   - 验证清单包含所有缺少的食材
   - 点击"复制"按钮
   - 粘贴到记事本，验证内容正确

### 性能验证

- 首次加载时间 < 3 秒
- AI 生成响应时间 < 10 秒
- 页面交互流畅（60 FPS）

### 兼容性验证

- Chrome/Edge（最新版本）
- Firefox（最新版本）
- Safari（最新版本）
- 移动端浏览器（iOS Safari、Android Chrome）

---

## 总结

这个开发流程遵循 MVP 理念，分三个阶段逐步实现功能：

1. **阶段 1（核心 MVP）:** 快速实现"输入食材 → 生成菜谱"的核心价值
2. **阶段 2（功能增强）:** 添加筛选、收藏等提升用户体验的功能
3. **阶段 3（进阶功能）:** 实现智能替代、营养分析等高级功能

每个阶段都有明确的验收标准，确保产品质量。建议先完成阶段 1，验证产品可行性后再进入后续阶段。
